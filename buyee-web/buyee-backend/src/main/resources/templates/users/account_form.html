<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{/common/fragments :: page_head('Account Details', 'none', 'form')}"/>

<body>
	<div>
	
		<!-- Header (navigation bar) -->	
		<div th:replace="~{/common/header :: navbar('Account')}"></div>
		
		<!-- Data Collection Form -->
		<form class="mt-3 container-fluid" th:action="@{/account/update}" method="post" style="margin: 0 auto" 
		      enctype="multipart/form-data" th:object="${user}">
			<input type="hidden" th:field="*{id}" />
			<div class="border border-secondary rounded p-3">
				<div class="mb-3"><h2>Account Details</h2></div>
				<hr/>
				<div class="form-group">
					<label class="col-form-label">
						<b>ID:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>
						[[${user.id}]]
					</label>
				</div>
				<div class="form-group">
					<label class="col-form-label"><b>Roles: </b>[[${user.roles}]]</label>
				</div>
				<div class="form-group mb-3">
					<label class="col-form-label" for="inputEmail"><b>Email: </b>[[${user.email}]]</label>
				</div>   
				<hr/>
				<div class="form-group mb-3" title="You password must be 2-20 characters long">
					<label class="col-form-label" for="inputPassword">Password</label>
					<div>
						<input type="password" class="form-control" th:field="*{password}" pattern=".{2,20}" 
							   placeholder="Leave blank if password is unchanged" id="inputPassword" 
							   oninput="checkPasswordMatch(document.getElementById('confirmPassword'))" />
					</div>
				</div>
				<div class="form-group mb-3" title="Enter the same password again">
					<label class="col-form-label" for="confirmPassword">Confirm Password</label>
					<div>
						<input type="password" class="form-control" pattern=".{2,20}" 
							   placeholder="Leave blank if password is unchanged" id="confirmPassword" 
							   oninput="checkPasswordMatch(this)"/>
					</div>
				</div>
				<div class="form-group mb-3" title="You first name must be 2-30 characters long">
					<label class="col-form-label" for="inputFirstName">First Name *</label>
					<div>
						<input type="text" class="form-control" th:field="*{firstName}" required pattern=".{2,30}" 
							   placeholder="First Name" id="inputFirstName" />
					</div>
				</div>
				<div class="form-group mb-3" title="You last name must be 2-30 characters long">
					<label class="col-form-label" for="inputLastName">Last Name *</label>
					<div>
						<input type="text" class="form-control" th:field="*{lastName}" required pattern=".{2,30}" 
							   placeholder="Last Name" id="inputLastName" />
					</div>
				</div>
				<div class="form-group mb-3" title="Image should be smaller than 1MB">
					<input type="hidden" th:field=*{photo}></input> 
					<label for="imageFile" class="form-label">Photo</label> 
					<input class="form-control text-muted mb-3" type="file" id="imageFile" name="image" 
					       accept="image/png image/jpeg">
					<img style="width: var(--main-thumbnail-width)" id="thumbnail" th:src="@{${user.photoPathString}}" />
				</div>
				<div>
					<span class="form-text text-muted">ps. Blanks marked with * are required</span>
				</div>
				<hr/>
				<div class="text-center">
					<input type="submit" value="Submit" class="btn btn-outline-danger m-2" /> 
					<input type="button" value="Cancel" class="btn btn-outline-dark" id="cancelButton" />
				</div>
			</div>
		</form>
		
		<!-- Footer -->
		<div th:replace="~{common/footer :: footer}"></div>
		
	</div>
	
	<script type="text/javascript" th:src="@{/js/common_form.js}"></script>
	<script type="text/javascript">
		moduleURL = "[[@{/}]]"
		
		MAX_FILE_SIZE = 1048576; // 1MB
		
		function checkPasswordMatch(confirmPassword) {
			if (confirmPassword.value != $("#inputPassword").val()) {
				confirmPassword.setCustomValidity("Password doesn't match!");
			} else {
				confirmPassword.setCustomValidity("");
			}
		};
	</script>
	
</body>

</html>
